{"version":3,"sources":["../../src/js/index.jsx"],"names":["DateRange","props","state","format","minDate","ymd","maxDate","startMonth","ym","startDate","endMonth","endDate","undefined","add","showCalendar","hoverTime","isSelecting","placeholder","lang","dateCallback","bind","type","setState","unit","section","name","time","date","timeArr","push","changeStartDate","changeEndDate","set","hour","minute","second","millisecond","dateSectionDisplay","calendarMouseLeave","isSelected","item","selectTime","mouseEnterTime","calendarChange","Component"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport moment from 'moment';\nimport CommonFn from './commonFn';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport CalendarSelect from './calendarSelect';\nimport 'font-awesome/css/font-awesome.css';\nimport '../assets/style/main.css';\n\nexport default class DateRange extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      format: props.format || 'x', // 日期格式\n      minDate: CommonFn.ymd(props.minDate || '1900-01-01'),\n      maxDate: CommonFn.ymd(props.maxDate || '2200-01-01'),\n      startMonth: CommonFn.ym(props.startDate), // 默认开始月份\n      endMonth: props.endDate ? CommonFn.ym(props.endDate)\n        : moment(props.startDate || undefined).add(1, 'months').format('YYYY-MM'), // 默认结束月份\n      showCalendar: false, // 是否显示日历\n      startDate: props.startDate ? CommonFn.ymd(props.startDate)\n        : '', // 默认开始时间\n      endDate: props.endDate ? CommonFn.ymd(props.endDate)\n        : '', // 默认结束时间\n      hoverTime: '', // 鼠标悬停的日期\n      isSelecting: '', //选择状态位：'', 'startDate', 'endDate'\n      placeholder: props.placeholder || 'YYYY-MM-DD',\n      lang: props.lang === 'zh-cn' ? 'zh-cn' : 'en',\n    };\n\n    this.dateCallback = this.dateCallback.bind(this);\n  }\n\n  // 显示、隐藏日历\n  dateSectionDisplay(type) {\n    const { startMonth, endMonth, showCalendar } = this.state;\n    if (showCalendar !== (type === 'show')) {\n      // 处理开始结束月份显示顺序\n      if (startMonth > endMonth) {\n        this.setState({\n          startMonth: endMonth,\n          endMonth: startMonth,\n        });\n      } else if (startMonth === endMonth) {\n        this.setState({\n          endMonth: moment(endMonth).add(1, 'month').format('YYYY-MM'),\n        });\n      }\n\n      this.setState({\n        showCalendar: type === 'show',\n        isSelecting: type === 'show' ? 'startDate' : '',\n      });\n    }\n  }\n\n  // 修改日历显示的年月\n  calendarChange(type, unit, section) {\n    const name = `${section}Month`;\n    this.setState({\n      [name]: moment(this.state[name]).add(type, unit).format('YYYY-MM'),\n    });\n  }\n\n  // 点击日历日期，选择时间\n  selectTime(time) {\n    if (this.state.isSelecting === 'startDate') {\n      this.setState({\n        startDate: time,\n        endDate: time,\n        isSelecting: 'endDate',\n        hoverTime: time,\n      }, this.dateCallback);\n    } else if (this.state.isSelecting === 'endDate') {\n      let { startDate, endDate } = this.state;\n      if (startDate > time) {\n        endDate = startDate;\n        startDate = time;\n      } else {\n        endDate = time;\n      }\n      this.setState({\n        startDate,\n        endDate,\n        isSelecting: '',\n        showCalendar: false,\n      }, this.dateCallback);\n    }\n  }\n\n  // 鼠标悬停日期，选中区域\n  mouseEnterTime(time) {\n    if (this.state.isSelecting === 'endDate') {\n      this.setState({ hoverTime: time });\n    }\n  }\n\n  // 日期是否被选中\n  isSelected(date) {\n    const { startDate, endDate, hoverTime } = this.state;\n    const timeArr = [startDate, endDate];\n    if (hoverTime) timeArr.push(hoverTime);\n    if (date > min(timeArr) && date < max(timeArr)) {\n      return 'selected';\n    } else if (date === min(timeArr) || date === max(timeArr)) {\n      return 'start-or-end-selected';\n    }\n    return '';\n  }\n\n  // 选择时间时，鼠标移出日历区域\n  calendarMouseLeave() {\n    if (this.state.isSelecting === 'endDate') {\n      this.setState({ hoverTime: '' });\n    }\n  }\n\n  // 回调组件外部方法，传出修改\n  dateCallback() {\n    const { changeStartDate, changeEndDate } = this.props;\n    const { startDate, endDate, format } = this.state;\n    if (changeStartDate) {\n      changeStartDate(moment(startDate).format(format));\n    }\n    if (changeEndDate) {\n      changeEndDate(\n        moment(endDate)\n          .set({\n            hour: 23,\n            minute: 59,\n            second: 59,\n            millisecond: 999,\n          })\n          .format(format)\n      );\n    }\n  }\n\n  render() {\n    const {\n      minDate,\n      maxDate,\n      startMonth,\n      endMonth,\n      startDate,\n      endDate,\n      showCalendar,\n      placeholder,\n      lang,\n    } = this.state;\n\n    return (\n      <div className=\"date-range-body\">\n        <div\n          className=\"input-section\"\n          onClick={() => this.dateSectionDisplay('show')}\n        >\n          <input type=\"text\" className=\"start-time\" value={startDate} placeholder={placeholder} />\n          <span className=\"clip-span\">——</span>\n          <input type=\"text\" className=\"end-time\" value={endDate} placeholder={placeholder} />\n        </div>\n\n        <div\n          className={`date-section ${showCalendar && 'date-section-show'}`}\n          onMouseLeave={() => this.calendarMouseLeave()}\n        >\n          <CalendarSelect\n            className=\"date-start-section\"\n            calendarMonth={startMonth}\n            minDate={minDate}\n            maxDate={maxDate}\n            lang={lang}\n            isSelected={item => this.isSelected(item)}\n            selectTime={item => this.selectTime(item)}\n            mouseEnterTime={item => this.mouseEnterTime(item)}\n            calendarChange={(type, unit) => this.calendarChange(type, unit, 'start')}\n          />\n          <CalendarSelect\n            className=\"date-end-section\"\n            calendarMonth={endMonth}\n            minDate={minDate}\n            maxDate={maxDate}\n            lang={lang}\n            isSelected={item => this.isSelected(item)}\n            selectTime={item => this.selectTime(item)}\n            mouseEnterTime={item => this.mouseEnterTime(item)}\n            calendarChange={(type, unit) => this.calendarChange(type, unit, 'end')}\n          />\n        </div>\n        {showCalendar &&\n        <div className=\"bg-for-close\" onClick={() => this.dateSectionDisplay('hide')} />\n        }\n      </div>\n    );\n  }\n}\n"]}