{"version":3,"sources":["../../src/js/index.jsx"],"names":["DateRange","props","state","format","minDate","ymd","maxDate","startMonth","ym","startDate","endMonth","endDate","add","showCalendar","hoverTime","isSelecting","dateCallback","bind","type","setState","unit","section","name","time","date","timeArr","push","changeStartDate","changeEndDate","console","log","set","hour","minute","second","millisecond","dateSectionDisplay","calendarMouseLeave","isSelected","item","selectTime","mouseEnterTime","calendarChange","Component"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport moment from 'moment';\nimport CommonFn from './commonFn';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport CalendarSelect from './calendarSelect';\n\nimport '../assets/style/main.css';\n\nexport default class DateRange extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      format: props.format || 'x', // 日期格式\n      minDate: CommonFn.ymd(props.minDate || '2016-01-02'),\n      maxDate: CommonFn.ymd(props.maxDate || '2100-01-01'),\n      startMonth: CommonFn.ym(props.startDate), // 默认开始月份\n      endMonth: props.endDate ? CommonFn.ym(props.endDate)\n        : moment(props.startDate).add(1, 'months').format('YYYY-MM'), // 默认结束月份\n      showCalendar: false, // 是否显示日历\n      startDate: props.startDate ? CommonFn.ymd(props.startDate)\n        : '', // 默认开始时间\n      endDate: props.endDate ? CommonFn.ymd(props.endDate)\n        : '', // 默认结束时间\n      hoverTime: '', // 鼠标悬停的日期\n      isSelecting: '', //选择状态位：'', 'startDate', 'endDate'\n    };\n\n    this.dateCallback = this.dateCallback.bind(this);\n  }\n\n  // 显示、隐藏日历\n  dateSectionDisplay(type) {\n    const { startMonth, endMonth, showCalendar } = this.state;\n    if (showCalendar !== (type === 'show')) {\n      // 处理开始结束月份显示顺序\n      if (startMonth > endMonth) {\n        this.setState({\n          startMonth: endMonth,\n          endMonth: startMonth,\n        });\n      } else if (startMonth === endMonth) {\n        this.setState({\n          endMonth: moment(endMonth).add(1, 'month').format('YYYY-MM'),\n        });\n      }\n\n      this.setState({\n        showCalendar: type === 'show',\n        isSelecting: type === 'show' ? 'startDate' : '',\n      });\n    }\n  }\n\n  // 修改日历显示的年月\n  calendarChange(type, unit, section) {\n    const name = `${section}Month`;\n    this.setState({\n      [name]: moment(this.state[name]).add(type, unit).format('YYYY-MM'),\n    });\n  }\n\n  // 点击日历日期，选择时间\n  selectTime(time) {\n    if (this.state.isSelecting === 'startDate') {\n      this.setState({\n        startDate: time,\n        endDate: time,\n        isSelecting: 'endDate',\n        hoverTime: time,\n      }, this.dateCallback);\n    } else if (this.state.isSelecting === 'endDate') {\n      let { startDate, endDate } = this.state;\n      if (startDate > time) {\n        endDate = startDate;\n        startDate = time;\n      } else {\n        endDate = time;\n      }\n      this.setState({\n        startDate,\n        endDate,\n        isSelecting: '',\n        showCalendar: false,\n      }, this.dateCallback);\n    }\n  }\n\n  // 鼠标悬停日期，选中区域\n  mouseEnterTime(time) {\n    if (this.state.isSelecting === 'endDate') {\n      this.setState({ hoverTime: time });\n    }\n  }\n\n  // 日期是否被选中\n  isSelected(date) {\n    const { startDate, endDate, hoverTime } = this.state;\n    const timeArr = [startDate, endDate];\n    if (hoverTime) timeArr.push(hoverTime);\n    if (date > min(timeArr) && date < max(timeArr)) {\n      return 'selected';\n    } else if (date === min(timeArr) || date === max(timeArr)) {\n      return 'start-or-end-selected';\n    }\n    return '';\n  }\n\n  // 选择时间时，鼠标移出日历区域\n  calendarMouseLeave() {\n    if (this.state.isSelecting === 'endDate') {\n      this.setState({ hoverTime: '' });\n    }\n  }\n\n  // 回调组件外部方法，传出修改\n  dateCallback() {\n    const { changeStartDate, changeEndDate } = this.props;\n    const { startDate, endDate, format } = this.state;\n    console.log(startDate, endDate);\n    if (changeStartDate) {\n      changeStartDate(moment(startDate).format(format));\n    }\n    if (changeEndDate) {\n      changeEndDate(\n        moment(endDate)\n          .set({\n            hour: 23,\n            minute: 59,\n            second: 59,\n            millisecond: 999,\n          })\n          .format(format)\n      );\n    }\n  }\n\n  render() {\n    const {\n      minDate,\n      maxDate,\n      startMonth,\n      endMonth,\n      startDate,\n      endDate,\n      showCalendar,\n    } = this.state;\n\n    return (\n      <div className=\"date-range-body\">\n        <div\n          className=\"input-section\"\n          onClick={() => this.dateSectionDisplay('show')}\n        >\n          <input type=\"text\" className=\"start-time\" value={startDate} />\n          <span className=\"clip-span\">——</span>\n          <input type=\"text\" className=\"end-time\" value={endDate} />\n        </div>\n\n        <div\n          className={`date-section ${showCalendar && 'date-section-show'}`}\n          onMouseLeave={() => this.calendarMouseLeave()}\n        >\n          <CalendarSelect\n            className=\"date-start-section\"\n            calendarMonth={startMonth}\n            minDate={minDate}\n            maxDate={maxDate}\n            isSelected={item => this.isSelected(item)}\n            selectTime={item => this.selectTime(item)}\n            mouseEnterTime={item => this.mouseEnterTime(item)}\n            calendarChange={(type, unit) => this.calendarChange(type, unit, 'start')}\n          />\n          <CalendarSelect\n            className=\"date-end-section\"\n            calendarMonth={endMonth}\n            minDate={minDate}\n            maxDate={maxDate}\n            isSelected={item => this.isSelected(item)}\n            selectTime={item => this.selectTime(item)}\n            mouseEnterTime={item => this.mouseEnterTime(item)}\n            calendarChange={(type, unit) => this.calendarChange(type, unit, 'end')}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"]}